<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Qiscus Meet - Sample</title>
  </head>
  <body>
    <h2>Qiscus Meet - Sample</h2>
    <div id="call-form">
      <div style="margin-bottom: 20px">
        Your Name: <input type="text" id="userName" readonly />
      </div>
      <div style="margin-bottom: 20px">
        Room Name: <input type="text" id="roomName" readonly />
      </div>
      <a id="call-button">
        <button>Call Other User</button>
      </a>
    </div>

    <div id="meet" style="height: 800px"></div>
  </body>

  <!-- Firebase -->
  <script src="./js/lib/const.js"></script>
  <script src="./js/config/firebase-config.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-messaging.js"></script>

  <!-- Qiscus Meet  -->
  <script src="https://call.qiscus.com/v2/qiscus_external_api.min.js"></script>
  <script src="https://call.qiscus.com/v2/qiscus_core_api.min.js"></script>

  <!-- Meet Config  -->
  <script src="./js/lib/functions.js"></script>
  <script src="./js/config/meet-config.js"></script>
  <script src="./js/firebase-functions.js"></script>

  <script>
    const callButton = document.getElementById("call-button");
    const callForm = document.getElementById("call-form");
    const meet = document.getElementById("meet");
    let token;
    // Trigger Call Button
    callButton.onclick = async function () {
      const room = appId + "/" + roomName;
      // Trigger FCM when Calling
      await notify(token, userName, room);

      // Show Qiscus Meet
      startCall();
      const data = getData(userName, roomName);
      const options = await getOptions(data, userName, room);

      let api = await new QiscusMeetExternalAPI(domain, options);

      // Triggered when user end the call
      await endCallCallback(api);
    };
  </script>
</html>
